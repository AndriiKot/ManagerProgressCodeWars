{
  "id": "64c4d0011141cb003eca9e18",
  "name": "Customers with All Orders Undelivered",
  "slug": "customers-with-all-orders-undelivered",
  "category": "reference",
  "publishedAt": "2023-07-29T08:38:29.379Z",
  "approvedAt": "2023-07-29T15:43:54.567Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/64c4d0011141cb003eca9e18",
  "rank": {
    "id": -7,
    "name": "7 kyu",
    "color": "white"
  },
  "createdAt": "2023-07-29T08:38:25.732Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "You are working as a data analyst for an e-commerce company. The company has a database containing all orders placed by customers. The management team wants to understand their delivery performance. Specifically, they want to identify customers for whom all their orders are still undelivered. \n\nYou are given an `orders` table in a PostgreSQL database. Each row in the table represents an order from a customer. The order may or may not have been delivered.\n\nThe table schema is as follows:\n\n1) `id` (integer) - The unique identifier for each order.\n2) `customer_id` (integer) - The identifier of the customer who placed the order. A customer can place multiple orders.\n3) `delivery_date` (date) - The date when the order was delivered. If the order has not been delivered yet, this field is NULL.\n\nHere's a sample representation of the data:\n\n```\n id | customer_id | delivery_date\n----+-------------+---------------\n  1 |           1 | 2023-07-01\n  2 |           1 | NULL\n  3 |           2 | NULL\n  4 |           2 | NULL\n  5 |           3 | 2023-07-03\n  6 |           3 | 2023-07-04\n  7 |           4 | NULL\n  8 |           4 | NULL\n  9 |           5 | 2023-07-05\n 10 |           5 | NULL\n ```\n \nYour task is to write an SQL query that selects all customers for whom all orders are undelivered. In other words, select the distinct `customer_id` values (no other columns) for which every corresponding `delivery_date` is NULL.\n\nReturn the result sorted in descending order by `customer_id`.\n\nGLHF!\n\n### Desired Output\n\nThe desired output should look like this:\n\n<table><!----><tr><th>customer_id</th></tr><tr><td>4</td></tr><tr><td>2</td></tr></table>\n\n\n\n\n",
  "totalAttempts": 2058,
  "totalCompleted": 503,
  "totalStars": 9,
  "voteScore": 64,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}