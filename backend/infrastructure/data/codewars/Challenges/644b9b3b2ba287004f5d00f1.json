{
  "id": "644b9b3b2ba287004f5d00f1",
  "name": "Finding the Friday Night DVD Rental Kings/Queens",
  "slug": "finding-the-friday-night-dvd-rental-kings-slash-queens",
  "category": "reference",
  "publishedAt": "2023-04-28T10:09:55.114Z",
  "approvedAt": "2023-05-19T07:11:14.940Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/644b9b3b2ba287004f5d00f1",
  "rank": {
    "id": -6,
    "name": "6 kyu",
    "color": "yellow"
  },
  "createdAt": "2023-04-28T10:08:59.935Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "Write a SQL query using the DVD rental database to find the top 50 customers who rented movies on Friday between 6 pm and midnight (i.e. 18:00 to 23:59). For each customer, the query should return their id,  full name, the total number of rentals they made on a Friday evening, and a comma-separated list of the dates (including the time) of those rentals, sorted in descending order.\n\n##### Notes:\n\n*  for the sample tests, static dump of [DVD Rental Sample Database](http://www.postgresqltutorial.com/postgresql-sample-database/) is used, for the final solution - random tests.\n* by \"top customers\" is meant that list should be sorted by the quantity of rentals from higher to lower and if number of rentals is the same - then by last name of a customer\n\nGood luck!\n\n### Schema\n(not all columns - part of the domain required to solve this kata)\n\n#### `customer` table:\n```\nColumn       | Type     | Modifiers\n------------ +----------+----------\ncustomer_id  | integer  | not null\nfirst_name   | varchar  | not null\nlast_name    | varchar  | not null\n```\n#### `rental` table:\n```\nColumn       | Type      | Modifiers\n-------------+-----------+----------\nrental_id    | integer   | not null\ncustomer_id  | integer   | not null\nrental_date  | timestamp | not null\nreturn_date  | timestamp | \n```\n\n### Desired Output\n\nThe desired output should look like this:\n\n```\ncustomer_id  | customer_name | friday_rentals | rental_dates\n-------------+---------------+----------------+----------------------------------------------\n   32        | Marcia Dean   | 14             | 2005-08-19 21:12:37, 2005-07-08 19:13:50  ...\n   14        | Hosea Jacobi  | 10             | 2005-08-19 21:31:31, 2005-07-29 19:18:57 ... \n...\n```\n\n",
  "totalAttempts": 1429,
  "totalCompleted": 222,
  "totalStars": 17,
  "voteScore": 54,
  "tags": [
    "Databases",
    "SQL"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 1,
    "suggestions": 1
  }
}