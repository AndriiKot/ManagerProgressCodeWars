{
  "id": "66aa0b0a9936648e423dd7ee",
  "name": "Runner Results with Position-Based Competitor Info",
  "slug": "runner-results-with-position-based-competitor-info",
  "category": "reference",
  "publishedAt": "2024-07-31T10:01:07.666Z",
  "approvedAt": "2024-09-16T21:30:25.221Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/66aa0b0a9936648e423dd7ee",
  "rank": {
    "id": -6,
    "name": "6 kyu",
    "color": "yellow"
  },
  "createdAt": "2024-07-31T09:59:38.838Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "Imagine you are working with a sports analytics company that tracks the performance of runners in various races. The company has a PostgreSQL database with three tables: `runners`, `runs`, and `races`. Your task is to create a report that lists all the races a specific runner (`runner_id  = 1`) participated in and includes additional insights about their competitors.\n\n`runners`:\n\n* `runner_id` (int): primary key\n* `name` (varchar): The name of the runner\n\n`runs`:\n\n* `run_id` (int): primary key\n* `runner_id` (int, foreign key to `runners`): ID of the runner who participated in the run \n* `race_id`:  (int, foreign key to `races`): ID of the race in which the run took place\n* `position` (int): The finishing position of the runner in the race \n\n\n`races`:\n\n* `race_id` (int): primary key\n* `date` (date): The date when the race took place \n\nCreate a query that lists all the races a given runner (`runner_id  = 1`) participated in, including the following columns:\n\n1) `runner_name`: The name of the runner\n2) `run_id`: The unique identifier for the run\n3) `position`: The finishing position of the runner in the race\n4) `race_id`: The unique identifier for the race\n5) `win/second`: A new column that:\n    * Displays the name and ID (in the format of `name (id)` of the runner who finished second if the current runner's position is 1\n    * Displays the name and ID (in the format of `name (id)` of the winning runner in that race if the current runner's position is not 1\n    \n    \nThe results should be ordered by the race date in ascending order. It is not possible to have multiple races on the same date so thus second ordering criterion is not needed.\n\nFor this sample data: \n\n```\nrunners\n\n| runner_id | name          |\n+-----------+---------------+\n|         1 | John Runner   |\n|         2 | Second Runner |\n|         3 | Winning Runner|\n```\n\n```\nraces\n\n| race_id | date                |\n+---------+---------------------+\n|       1 | 2024-07-01          |\n|       2 | 2024-07-02          |\n|       3 | 2024-07-03          |\n```\n\n```\nruns\n\n| run_id | runner_id | race_id | position |\n+--------+-----------+---------+----------+\n|      1 |         1 |       1 |        1 |\n|      2 |         2 |       1 |        2 |\n|      3 |         3 |       1 |        3 |\n|      4 |         1 |       2 |        3 |\n|      5 |         2 |       2 |        1 |\n|      6 |         3 |       2 |        2 |\n|      7 |         1 |       3 |        2 |\n|      8 |         2 |       3 |        3 |\n|      9 |         3 |       3 |        1 |\n```\n\nthe desired output is the following:\n\n```\n| runner_name  | run_id | position | race_id | win/second        |\n+--------------+--------+----------+---------+-------------------+\n| John Runner  |      1 |        1 |       1 | Second Runner (2) |\n| John Runner  |      4 |        3 |       2 | Second Runner (2) |\n| John Runner  |      7 |        2 |       3 | Winning Runner (3)|\n```\n\nGLHF!",
  "totalAttempts": 976,
  "totalCompleted": 229,
  "totalStars": 12,
  "voteScore": 42,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}