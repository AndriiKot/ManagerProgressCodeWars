{
  "id": "64b53243d44a86004b063466",
  "name": "Classifying Transactions by Number of Suppliers",
  "slug": "classifying-transactions-by-number-of-suppliers",
  "category": "reference",
  "publishedAt": "2023-07-17T13:12:51.474Z",
  "approvedAt": "2023-07-22T18:18:48.217Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/64b53243d44a86004b063466",
  "rank": {
    "id": -7,
    "name": "7 kyu",
    "color": "white"
  },
  "createdAt": "2023-07-17T12:21:23.410Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "You are a database administrator at a wholesale company that deals with multiple suppliers. The company keeps track of all its transactions in two PostgreSQL tables: `transaction` and `transaction_content`.\n\nThe `transaction` table contains information about each transaction, identified by a unique `transaction_id` and the `date` the transaction took place:\n```\n| transaction_id | date       |\n+----------------+------------+\n|      1         | 2023-07-17 |\n|      2         | 2023-07-17 |\n```\nThe `transaction_content` table contains detailed information about the items in each transaction, including the `product_code`, `supplier`, and `quantity` of each item:\n```\n| transaction_id | product_code | supplier  | quantity |\n+----------------+--------------+-----------+----------+\n|      1         |    8008554   | SupplierA |    3     |\n|      1         |    8008579   | SupplierA |    4     |\n|      1         |    9870560   | SupplierA |    5     |\n|      2         |    8008554   | SupplierA |    7     |\n|      2         |    8081784   | SupplierB |    1     |\n|      2         |    8217471   | SupplierA |   23     |\n```\n\nAs the company deals with multiple suppliers, a single transaction can include items from more than one supplier.\n\nWrite a SQL query to generate a report that shows the `transaction_id`, `date`, and `supplier` for each transaction. If a transaction includes items from multiple suppliers, the supplier column should display 'Several'. If all items in a transaction are from the same supplier, display the name of that supplier. The result should be ordered by `transaction_id` in ascending order.\n\nSo thus for above sample data, the solution would be: \n\n```\n| transaction_id | date       | supplier  |\n+----------------+------------+-----------+\n|      1         | 2023-07-17 | SupplierA |\n|      2         | 2023-07-17 | Several   |\n```\n\nGLHF!\n\n\n",
  "totalAttempts": 957,
  "totalCompleted": 282,
  "totalStars": 7,
  "voteScore": 58,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}