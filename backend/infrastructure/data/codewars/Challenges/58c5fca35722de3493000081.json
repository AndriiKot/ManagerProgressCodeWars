{
  "id": "58c5fca35722de3493000081",
  "name": "Playing with Sandpiles",
  "slug": "playing-with-sandpiles",
  "category": "algorithms",
  "publishedAt": "2017-03-13T03:27:53.473Z",
  "approvedAt": "2020-07-28T17:02:27.590Z",
  "languages": [
    "javascript",
    "kotlin",
    "python"
  ],
  "url": "https://www.codewars.com/kata/58c5fca35722de3493000081",
  "rank": {
    "id": -5,
    "name": "5 kyu",
    "color": "yellow"
  },
  "createdAt": "2017-03-13T01:57:55.716Z",
  "createdBy": {
    "username": "OverZealous",
    "url": "https://www.codewars.com/users/OverZealous"
  },
  "approvedBy": {
    "username": "user9644768",
    "url": "https://www.codewars.com/users/user9644768"
  },
  "description": "> [Learn about Sandpile numbers from Numberphile!](https://www.youtube.com/watch?v=1MtEUErz7Gg)\n\nLet's learn about a new type of number: the Sandpile.\n\n## What are Sandpiles?\n\nA sandpile is a grid of piles of sand ranging from `0` to some max integer value. For simplicity's sake, we'll look at a `3x3` grid containing `0`, `1`, `2`, or `3` grains of sand.\n\nAn example of this sort of sandpile might look like this:\n\n```\n1 3 0     . ∴ \n1 2 1  =  . : .\n3 2 2     ∴ : :\n```\n\nThis means that in row one, column one, there's `1` grain of sand, then `3` grains, then `0`, etc.\n\n## Sandpile Math\n\nI mentioned that Sandpiles are a form of number, and as numbers, they support a single operation: addition. To add two sandpiles, simply add the number of grains of sand within each cell with the matching cell in the second value:\n\n```\n1 3 0   2 0 2   (1+2) (3+0) (0+2)   3 3 2\n1 2 1 + 2 1 0 = (1+2) (2+1) (1+0) = 3 3 1\n3 2 2   0 0 1   (3+0) (2+0) (2+1)   3 2 3\n```\n\n## Toppling Piles\n\nYou probably already have wondered, what happens if the number of grains goes above our max value of `3`? The answer is, that pile topples over. If the pile is in the middle, it dumps one grain of sand to each neighbor, keeping whatever is left over. If it's on the edge, it loses one grain to each direct neighbor _and also loses_ one grain for any edges that are on the side, which just disappear. This means that, no matter what, the over-sized cell loses `4` grains of sand, while any neighboring cells gain `1` grain of sand.\n\nThis repeats until we've reached a state or equilibrium, like so:\n\n```\n                           *            *\n1 3 0   3 0 2   4 3 2    * 0 5 2      2 1 3      2 1 3\n1 2 1 + 2 3 0 = 3 5 1 =>   5 1 2 => * 1 3 2 =>   2 3 2 =>\n3 2 2   0 0 1   3 2 3      3 3 3      4 3 3    * 0 4 3\n                                                 *\n\n                                                   *\n                2 1 3    2 2 3      2 2 4      2 3 0 *\n             => 2 4 2 => 3 0 4   => 3 1 0 * => 3 1 1\n                1 0 4    1 2 0 *    1 2 1      1 2 1\n                  *          *\n```\n\nSo the final sum looks like this.\n\n```\n1 3 0   3 0 2   2 3 0\n1 2 1 + 2 3 0 = 3 1 1\n3 2 2   0 0 1   1 2 1\n```\n\nThat's a lot of work, and fairly error-prone. (Trust me!)\n\n## The Challenge\n\nWe want to create a class, `Sandpile`, that simulates the `3x3`, max `3` sandpile. This class should have the following properties:\n\n- The constructor optionally takes a string, which is 3 groups of 3 integers (`0-9`), separated by a newline. If any of the values of the integers are over `3`, then immediately topple each pile until the Sandpile is at rest. If no argument is provided, initialize the piles with all zeros.\n- There should be a `toString` method, which prints the sandpile the same way as the constructor. This will be used to validate your results.\n- There should be an `add` method, which takes another Sandpile as an argument. This method returns a _new_ Sandpile, with the sum of the previous Sandpiles.\n- Sandpiles are immutable after creation\n- To let you focus on the fun part of this challenge, you don't have to worry about validation:\n    - The input to the contructor will either be nothing or a string that matches `/[0-9]{3}\\n[0-9]{3}\\n[0-9]{3}/`\n    - The `add` function will only ever receive another `Sandpile` instance.\n\n## Thinking Ahead\n\nWhile working on this, think about what might be involved in a more generic Sandpile class, which could have a grid of any dimension, or allow for different numbers of grains before toppling over.\n\nIf you like this Kata, I'll look at an extended version tackling the dynamic sandpile.",
  "totalAttempts": 1021,
  "totalCompleted": 156,
  "totalStars": 27,
  "voteScore": 100,
  "tags": [
    "Algorithms"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 2,
    "suggestions": 1
  }
}