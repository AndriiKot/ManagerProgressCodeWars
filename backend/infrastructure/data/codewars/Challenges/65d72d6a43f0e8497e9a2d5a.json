{
  "id": "65d72d6a43f0e8497e9a2d5a",
  "name": " Reporting on House Maintenance Tasks Completion",
  "slug": "reporting-on-house-maintenance-tasks-completion",
  "category": "reference",
  "publishedAt": "2024-02-22T11:50:22.343Z",
  "approvedAt": "2024-02-23T14:04:27.557Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/65d72d6a43f0e8497e9a2d5a",
  "rank": {
    "id": -6,
    "name": "6 kyu",
    "color": "yellow"
  },
  "createdAt": "2024-02-22T11:18:02.776Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "A home maintenance company uses a database to keep track of tasks that need to be performed at various houses. The database has two tables: `house_tasks` and `task_status`. The `house_tasks` table contains a list of tasks scheduled for each house identified by a `house_id`. The `task_status` table tracks the progress of each task, including a description and its current status.\n\n`house_tasks`:\n\n* `task_id` (int, primary key): A unique identifier for each task.\n* `house_id` (int): The identifier of the house for which the task is scheduled.\n* `task_name` (varchar): The name of the task to be performed.\n\n`task_status`: \n\n* `id` (int, primary key): A unique identifier for each task status record.\n* `task_id` (int): The identifier of the task which this status relates to.\n* `description` (varchar): A brief description of the task status.\n* `task_status` (varchar): The current status of the task; it can be 'Completed', 'In Progress', or NULL if the status has not been set.\n\nWrite a SQL query that generates a report for each house. The report should include the following columns:\n\n1) `house_id`: The identifier of the house.\n2) `total_tasks`: The total number of tasks scheduled for the house.\n3) `completed_tasks`: The number of tasks that have been completed. A task is considered completed if all of its corresponding statuses in the `task_status` table are set to 'Completed'.\n4) `incomplete_tasks`: The number of tasks that are not completed. A task is considered incomplete if any of its statuses are not 'Completed' or if the task does not have any status record in the `task_status` table.\n\nThe result should be ordered by `house_id` in descending order.\n\nFor this sample data:\n\n```\nhouse_tasks:\n\n| task_id | house_id | task_name |\n+---------+----------+-----------+\n| 1       | 1        | Paint     |\n| 2       | 1        | Plumb     |\n| 3       | 1        | Garden    |\n| 4       | 2        | Electric  |\n| 5       | 2        | Roof      |\n| 6       | 3        | Cleanup   |\n| 7       | 4        | Extra Work|\n```\n\n```\ntask_status:\n\n| task_id | description | task_status |\n+---------+-------------+-------------+\n| 1       | Desc 1      | Completed   |\n| 1       | Desc 2      | Completed   |\n| 1       | Desc 3      | Completed   |\n| 2       | Desc 4      | In Progress |\n| 2       | Desc 5      | In Progress |\n| 3       | Desc 6      | In Progress |\n| 3       | Desc 7      | Completed   |\n| 4       | Desc 8      | Completed   |\n| 5       | Desc 9      | NULL        |\n| 7       | Desc 10     | NULL        |\n| 7       | Desc 11     | Completed   |\n```\ndesired output is the following:\n\n```\n| house_id | total_tasks | completed_tasks | incomplete_tasks |\n+----------+-------------+-----------------+------------------+\n| 4        | 1           | 0               | 1                |\n| 3        | 1           | 0               | 1                |\n| 2        | 2           | 1               | 1                |\n| 1        | 3           | 1               | 2                |\n```\n\nGLHF!\n",
  "totalAttempts": 1215,
  "totalCompleted": 146,
  "totalStars": 11,
  "voteScore": 47,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}