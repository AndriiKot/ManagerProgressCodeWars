{
  "id": "64ad157a0c6952004b172c5f",
  "name": "Panda's leaked report with daily stats: Sales by 30 Minutes",
  "slug": "pandas-leaked-report-with-daily-stats-sales-by-30-minutes",
  "category": "reference",
  "publishedAt": "2023-07-11T11:24:47.516Z",
  "approvedAt": "2023-07-12T10:03:05.542Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/64ad157a0c6952004b172c5f",
  "rank": {
    "id": -5,
    "name": "5 kyu",
    "color": "yellow"
  },
  "createdAt": "2023-07-11T08:40:26.213Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "While visiting his favorite store, Panda, on May 9, 2023, one [redditor](https://www.reddit.com/r/mildlyinteresting/comments/13d2zdi/panda_accidentally_gave_me_their_daily_stats_with/) found something interesting along with his purchase receipt. The store clerk accidentally included a printout of their daily sales statistics. He was amazed to see how detailed the sales data is: it breaks down the number and total amount of sales for each half-hour interval within the day, and even includes the percentage of sales for each interval compared to the total sales for the day!\n\n<p><img alt=\"sequence of moves for level1\" width=\"400px\" height=\"700px\" src=\"https://i.imgur.com/LcV4mwR.jpeg\"></p> \n\nLet's try and replicate this detailed sales report using PostgreSQL!\n\nCreate an SQL report to calculate the number and total amount of sales for each half-hour interval within a given day. The report should include the percentage of sales for each interval compared to the total sales for the day.\n\nLet's assume you have access to a PostgreSQL database with a `sales` table. The sales table has the following schema:\n\n* `id` (integer): A unique identifier for each record.\n* `timestamp` (timestamp): The date and time of the sale.\n* `amount` (decimal): The amount of the sale.\n\nYou need to write an SQL query that generates a report with the following columns for May 8, 2023 from 10:00 AM to 10:30 PM:\n\n* `Time` (varchar): The half-hour interval, formatted as 'HH12:MI AM'-'HH12:MI AM' (for example, '10:00 AM-10:30 AM').\n* `Cnt` (int): The number of sales within the interval.\n* `Sales` (money): The total amount of sales within the interval. The currency symbol should be a dollar sign ('$'). The formatting should be handled by PostgreSQL's `money` datatype.\n* `%Sales` (numeric): The percentage of sales within the interval compared to the total sales for the day. This should be calculated as (interval sales / total sales) * 100, and rounded to two decimal places.\n\nNotes:\n\n* If a sale occurrs exactly at 10:30, it will be included in the \"10:30AM-11:00AM\" interval, not the \"10:00AM-10:30AM\" interval. This is a common way to handle such situations in time series analysis and ensures that every sale belongs to exactly one interval.\n* You should include all intervals from 10:00 AM to 10:30 PM, even if there are no sales within some intervals.\n* The sales data may include multiple sales with the same timestamp. Make sure your query correctly handles this situation.\n* Sales are only made during the operating hours of 10:00 AM - 10:30 PM. There are no sales during this day that are out of the boundaries.\n\nGLHF!\n\n### Desired Output\n\nThe desired output should look like this:\n\n<table><!----><tr><th>Time</th><th>Cnt</th><th>Sales</th><th>%Sales</th></tr><tr><td>10:00 AM-10:30 AM</td><td>9</td><td>$   915.08</td><td>0.535e1</td></tr><tr><td>10:30 AM-11:00 AM</td><td>10</td><td>$   804.87</td><td>0.471e1</td></tr><tr><td>11:00 AM-11:30 AM</td><td>10</td><td>$   854.03</td><td>0.5e1</td></tr></table>\n...",
  "totalAttempts": 1700,
  "totalCompleted": 119,
  "totalStars": 12,
  "voteScore": 31,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}