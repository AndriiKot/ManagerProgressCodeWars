{
  "id": "6482f40455c862529b38992a",
  "name": "Employees and managers: Part 1",
  "slug": "employees-and-managers-part-1",
  "category": "reference",
  "publishedAt": "2023-06-09T10:49:23.805Z",
  "approvedAt": "2023-06-24T08:46:11.152Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/6482f40455c862529b38992a",
  "rank": {
    "id": -7,
    "name": "7 kyu",
    "color": "white"
  },
  "createdAt": "2023-06-09T09:42:28.219Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "You have been provided with a PostgreSQL database that contains an `employees` table. The `employees` table has the following structure:\n\n* `id`: an integer column that uniquely identifies each employee.\n* `name`: a text column that contains the name of the employee.\n* `manager_id`: an integer column that identifies the manager of each employee. The `manager_id` corresponds to an `id` in the same employees table. This means that our table has a recursive relationship with itself - an employee can be a manager to other employees. It is nullable: top managers do not have managers above them.\n\nYour task is to write a SQL query that meets the following requirements:\n\n* The query should output a list of all managers and their respective employees, grouped by the `manager_id`.\n* The output of your query should be a table with two columns:\n  * `manager_id`:  ID of each manager.\n  * `employee_names`: an array of all the names of employees who have that manager. Each entry in the array should be a string of the form `employee_name (employee_id)`. The employees in each array should be ordered by their id in ascending order.\n* We should avoid displaying `null` for `manager_id` colummn in the result set. \n* The output rows should be ordered by `manager_id` in ascending order.\n\nGood Luck!\n\n### Desired Output\n\nThe desired output should look like this:\n```\nmanager_id  | employee_names                                                       |\n------------+----------------------------------------------------------------------|\n 1          | {\"Lewis Fadel (4)\",\"Nicole Konopelski (7)\",\"Dwayne Wilderman (10)\"}  | \n 2          | {\"Katharina Ferry (43)\",\"Williemae Ledner (79)\"}                     |\n...\n```\n\n\n\n\n\n\n\n",
  "totalAttempts": 1732,
  "totalCompleted": 335,
  "totalStars": 11,
  "voteScore": 61,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}