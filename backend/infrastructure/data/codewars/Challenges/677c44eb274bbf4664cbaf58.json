{
  "id": "677c44eb274bbf4664cbaf58",
  "name": "The Great Data Entry Blame Game",
  "slug": "the-great-data-entry-blame-game",
  "category": "reference",
  "publishedAt": "2025-01-09T20:47:07.738Z",
  "approvedAt": "2025-01-11T14:27:04.666Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/677c44eb274bbf4664cbaf58",
  "rank": {
    "id": -6,
    "name": "6 kyu",
    "color": "yellow"
  },
  "createdAt": "2025-01-06T21:02:35.947Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "At Company X, employee certifications are a big deal. Certificates are essential for promotions, training programs, and awards. But lately, there’s been an uproar: employees are fuming about typos in their names on official certificates.\n\nManagement has been inundated with complaints:\n\n* \"Why does my certificate say 'Jon Smyth' when my name is 'John Smith'?\"\n* \"Who is 'Jane Do'? Is that supposed to be me?\"\n* \"I’m so tired of correcting my name for the third time!\"\n\nThis chaos has sparked a blame game between data entry specialists. Management hears excuses like:\n\n* \"It’s not my fault! The names were misspelled in the source data!\"\n* \"I only copy what’s given to me!\"\n* \"Maybe it was Alice who messed it up this time!\"\n\nManagement is tired of the finger-pointing. They decide to settle this once and for all with hard metrics...\n\n### Objective\n\nYou, as a data analyst, are tasked with identifying errors in certification records created by data entry specialists. Complaints have surfaced about typos in certification names, and management wants actionable metrics to:\n\n1) Identify the specialists responsible for the most errors.\n2) Quantify the extent of these errors.\n3) Improve data entry processes by retraining staff or implementing validation systems.\n\nYour analysis must focus on records where the Levenshtein distance (edit distance) between the employee’s correct name and the name on their certificate is between 1 and 3, indicating likely typos. Direct string comparison (`employees.name != certifications.cert_name`) is insufficient because `cert_name` values sometimes may be entirely unrelated to the employee's name (e.g., an organization name or another person's name).\n\nWe have `employees` table: \n\n* `id` (int, primary key): Unique identifier for the employee.\n* `name` (varchar): Correct name of the employee.\n\nand `certifications` table:\n\n* `id` (int, primary key): Unique identifier for the certification record.\n* `employee_id`\t(int):\tForeign key referencing `employees.id`.\n* `cert_name` (varchar):\tName on the certification record (entered by a specialist).\n* `entered_by` (int):\tId of the data entry specialist who created or updated the record.\n* `updated_at` (timestamp): Date and time the certification record was last updated.\n\nRequirements: \n\n1) Use the Levenshtein function (`levenshtein(string1, string2)`) to calculate the edit distance between `employees.name` and `certifications.cert_name`. We take into account records where the Levenshtein distance is between 1 and 3, as these likely represent typos in the employee’s name. This function is included in the database setup - you don't need to enable/create it manually.\n\n2) Calculate the percentage of total errors attributable to each specialist.\n\nResultant columns: \n\n1) `specialist_id` (int): The unique ID of the specialist (certifications.entered_by).\n2) `error_count`: Total number of records entered by the specialist with Levenshtein distances between 1 and 3.\n3) `error_percentage` (varchar): The percentage of total errors caused by this specialist (calculated as (Error Count / Total Errors) * 100). It should be: \n    * Rounded to two decimal places for clarity and precision.\n    * Converted to a string (varchar) for better display and formatting in reports.\n    \nThe primary ordering criterion is `error_count` desc (highest errors first). And secondly, by `specialist_id` in the case of a tie.\n\nFor this sample data:\n\n```\nemployees: \n\n| id | name           |\n+----+----------------+\n| 1  | John Smith     |\n| 2  | Jane Doe       |\n| 3  | Annabelle Lee  |\n```\n\n```\ncertifications: \n\n| id  | employee_id | cert_name     | entered_by | updated_at          |\n+-----+-------------+---------------+------------+---------------------+\n| 101 | 1           | Jon Smith     | 1          | 2023-01-15 09:00:00 |\n| 102 | 1           | John Smit     | 2          | 2023-02-10 14:00:00 |\n| 103 | 2           | Jane Do       | 1          | 2023-01-20 08:00:00 |\n| 104 | 2           | Acme Corp.    | 3          | 2023-01-25 12:00:00 |\n| 105 | 3           | Annabel Lee   | 1          | 2023-03-01 10:00:00 |\n```\n\nthe expected output is the following: \n\n\n```\n| specialist_id | error_count | error_percentage |\n+---------------+-------------+------------------+\n| 1             | 3           | 75.00            |\n| 2             | 1           | 25.00            |\n```\n\nGLHF!\n\n",
  "totalAttempts": 1224,
  "totalCompleted": 221,
  "totalStars": 15,
  "voteScore": 35,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}