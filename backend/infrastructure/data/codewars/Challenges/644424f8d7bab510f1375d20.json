{
  "id": "644424f8d7bab510f1375d20",
  "name": "Films selection with a twist",
  "slug": "films-selection-with-a-twist",
  "category": "reference",
  "publishedAt": "2023-04-23T05:26:24.957Z",
  "approvedAt": "2023-05-04T17:42:24.427Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/644424f8d7bab510f1375d20",
  "rank": {
    "id": -6,
    "name": "6 kyu",
    "color": "yellow"
  },
  "createdAt": "2023-04-22T18:18:32.364Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "For this task we need to get film_id, film title and length from the `film` table in the DVD rental database, but with a twist: we need to exclude films with a length between the minimum length of `R`-rated films and the median length of `PG-13` rated films. This means that the selected films will be either strictly shorter than the shortest R-rated film or strictly longer than of median length PG-13 rated film\n\n##### Notes:\n\n*  for the sample tests, static dump of [DVD Rental Sample Database](http://www.postgresqltutorial.com/postgresql-sample-database/) is used, for the final solution - random tests.\n* List should be sorted by the length of film from to lower higher and if length is the same - then by title of film alphabetically, if even titles are the same - then by film_id in asc order.\n* Since `length` is an integer, we should use `PERCENTILE_DISC` to calculate a median. `percentile_disc` returns a discrete value from the dataset that matches the specified percentile, while `percentile_cont` returns an interpolated value that lies between two adjacent data points. So for a dataset of discrete values, like integer lengths of films in our task, `percentile_disc` would be more appropriate to use for calculating percentiles, while for a dataset of continuous values, like temperature measurements, `percentile_cont` would be more appropriate.  \n(kudos to Voile for bringing this out)\n\n### Schema:\n\n#### `film` table:\n```\nColumn            | Type      | Modifiers\n------------------+-----------+-----------\nfilm_id           | integer   | not null\ntitle             | varchar   | not null\ndescription       | text      | not null\nrelease_year      | integer   | not null\nlanguage_id       | integer   | not null \nrental_duration   | integer   | not null\nrental_rate       | numeric   | not null\nlength            | integer   | not null\nreplacement_cost  | numeric   | not null\nrating            | varchar   | not null\nlast_update       | timestamp | not null\n```\n\n### Desired Output\n\nThe desired output should look like this:\n```\nfilm_id | title                             | length |\n--------+-----------------------------------+--------|\n   32   | The Shawshank Redemption          | 40     | \n   14   | Monty Python and the Holy Grail   | 41     |\n...\n```",
  "totalAttempts": 855,
  "totalCompleted": 243,
  "totalStars": 9,
  "voteScore": 58,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 1
  }
}