{
  "id": "64cf40ec4e8a907582e32768",
  "name": "Consolidating Sales and Returns Data",
  "slug": "consolidating-sales-and-returns-data",
  "category": "reference",
  "publishedAt": "2023-08-06T06:47:50.611Z",
  "approvedAt": "2023-08-07T11:05:37.617Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/64cf40ec4e8a907582e32768",
  "rank": {
    "id": -7,
    "name": "7 kyu",
    "color": "white"
  },
  "createdAt": "2023-08-06T06:42:53.015Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "The business tracks its product sales and product returns in two separate tables: `table_sales` and `table_returns`. Both tables have the same structure:\n\n* `id` (integer): primary key\n* `product_id` (string): ID of the product.\n* `quantity` (integer): Number of products sold/returned.\n* `date` (date): Date of the sale/return.\n\nFetch the consolidated data such that the output columns are:\n\n* `product_id`: ID of the product.\n* `sale_qty`: Quantity sold on the date. If no sales are available for that date, show NULL.\n* `return_qty`: Quantity returned on the date. If no returns are available for that date, show NULL.\n* `date`: Date of the transaction.\n\nNotes:\n\n* Only one transaction for a `product_id` per date is possible.\n* The results should be sorted by `product_id` and then by `date` both in ascending order.\n\n\nSo thus for such a sample data:\n\n`table_sales:`\n```\nid | product_id | quantity |    date    \n---+------------+----------+------------\n 1 | c001       |       20 | 2023-08-03\n 2 | t008       |       30 | 2023-08-01\n 3 | t008       |       20 | 2023-08-03\n 4 | c001       |       90 | 2023-08-09\n ```\n\n`table_returns:`\n\n```\nid | product_id | quantity |    date    \n---+------------+----------+------------\n 1 | t008       |       40 | 2023-08-08\n 2 | t008       |       30 | 2023-08-01\n 3 | c001       |       10 | 2023-08-03\n ```\n \n The desired out is the following:\n\n```\nproduct_id | sale_qty | return_qty |    date    \n-----------+----------+------------+------------\nc001       |       20 |         10 | 2023-08-03\nc001       |       90 |     NULL   | 2023-08-09\nt008       |       30 |         30 | 2023-08-01\nt008       |       20 |     NULL   | 2023-08-03\nt008       |    NULL  |         40 | 2023-08-08\n```\n\nGLHF!\n ",
  "totalAttempts": 1397,
  "totalCompleted": 184,
  "totalStars": 10,
  "voteScore": 49,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 2,
    "suggestions": 0
  }
}