{
  "id": "64d499812df37400210180e4",
  "name": " Six Consecutive 'No' Outcomes in Customer Calls",
  "slug": "six-consecutive-no-outcomes-in-customer-calls",
  "category": "reference",
  "publishedAt": "2023-08-10T09:18:54.527Z",
  "approvedAt": "2023-08-11T09:56:43.852Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/64d499812df37400210180e4",
  "rank": {
    "id": -5,
    "name": "5 kyu",
    "color": "yellow"
  },
  "createdAt": "2023-08-10T08:02:09.538Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "We're analyzing data for a customer support center for a tech company. The \"No\" outcomes represent failed attempts by companies automated voice assistant to understand customer requests.\n\nNow, if the voice assistant fails to understand the same customer six times in a row, a live support agent takes over the call.\n\nTable Schema (`calls`):\n\n* `call_id` (integer) - The unique identifier for each call.\n* `user_id` (integer) - The unique identifier for the customer.\n* `outcome` (varchar) - The outcome of the voice assistant's attempt to understand the customer's request. Can be either 'Yes' (understood) or 'No' (not understood).\n* `date_of_call` (timestamp) - The date and time when the call occurred.\n\nYour task is to write a PostgreSQL query to find instances where the voice assistant failed to understand the same customer six times in a row. The result should include the details of the sixth consecutive \"No\" call.\n\nThe result set should include `user_id` (integer) and `date_of_call` (text) columns and be sorted by `user_id` and `date_of_call` in ascending order. \n\nGLHF!\n\nNotes:\n\n1) It is guaranteed that each call for user has unique timestamp and in ascending chronological order.\n\n2) If a user has 12 consecutive \"No\" outcomes, the query should only return the 6th \"No,\" not both the 6th and 12th.\n\n3) If a user has two separate series of 6 consecutive \"No\" outcomes, each separated by a different outcome, both occurrences of the 6th \"No\" should be returned.\n\n### Desired Output\n\nThe desired output should look like this:\n\n<table><!----><tr><th>user_id</th><th>date_of_call</th></tr><tr><td>1</td><td>2022-01-01 00:50:00</td></tr><tr><td>1</td><td>2022-01-01 02:00:00</td></tr><tr><td>2</td><td>2022-01-01 01:20:00</td></tr></table>\n...\n\n\n\n",
  "totalAttempts": 2818,
  "totalCompleted": 197,
  "totalStars": 17,
  "voteScore": 40,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}