{
  "id": "65d5b19e0388920aba64a115",
  "name": "Backtracking Contributions: Unveiling the Penultimate Team Member in Project Task Management",
  "slug": "backtracking-contributions-unveiling-the-penultimate-team-member-in-project-task-management",
  "category": "reference",
  "publishedAt": "2024-02-21T08:17:56.029Z",
  "approvedAt": "2024-04-01T11:35:26.004Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/65d5b19e0388920aba64a115",
  "rank": {
    "id": -7,
    "name": "7 kyu",
    "color": "white"
  },
  "createdAt": "2024-02-21T08:17:34.936Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "You are provided with a PostgreSQL database that contains a table `project_tasks` used for tracking the progress of tasks in a company project. The table structure is as follows:\n\n* `task_id` (int): Unique identifier for each task.\n* `initial_assignment` (varchar): The team member initially assigned to the task.\n* `first_review` (varchar): The team member who conducted the first review.\n* `second_review` (varchar): The team member who conducted the second review.\n* `final_review` (varchar): The team member who conducted the final review.\n* `completion` (varchar): The team member who marked the task as completed.\n\nEach column, apart from `task_id`, can have null values.\n\nWrite an SQL query hat selects two columns: `task_id` and `second_last_contributor`. `second_last_contributor` should be the name of the team member who last worked on the task, excluding the current stage. For example, if a task is in the` final_review` stage, `second_last_contributor` should show who conducted the `second_review`. \n\nTasks can skip stages. For example, a task might move directly from `initial_assignment` to `final_review` without intermediate reviews (all columns in between are `null`). This reflects real-world situations where previously set stages may become null (e.g., a reviewer being removed).\n\nSorting should be by `task_id` in descending order.\n\nFor example, for this sample data:\n\n1) task_id: 1, initial_assignment: 'Alice', first_review: 'Bob', second_review: 'Charlie', final_review: 'Diana', completion: 'Eva'\n2) task_id: 2, initial_assignment: 'Alice', first_review: 'Bob'\n3) task_id: 3, initial_assignment: 'Alice'\n4) task_id: 4, initial_assignment: 'Frank', first_review: 'Grace', second_review: 'Hank'\n5) task_id: 5, initial_assignment: 'Ian', first_review: 'Jack', second_review: 'Kathy', final_review: 'Liam'\n6) task_id: 6, initial_assignment: 'Mona', first_review: 'Nate', second_review: 'Olivia', final_review: 'Pete', completion: 'Quinn'\n\nthe desired output is the following;\n\n<table><!----><tr><th>task_id</th><th>second_last_contributor</th></tr><tr><td>6</td><td>Pete</td></tr><tr><td>5</td><td>Kathy</td></tr><tr><td>4</td><td>Grace</td></tr><tr><td>3</td><td></td></tr><tr><td>2</td><td>Alice</td></tr><tr><td>1</td><td>Diana</td></tr></table>\n\nGLHF!",
  "totalAttempts": 456,
  "totalCompleted": 147,
  "totalStars": 7,
  "voteScore": 39,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}