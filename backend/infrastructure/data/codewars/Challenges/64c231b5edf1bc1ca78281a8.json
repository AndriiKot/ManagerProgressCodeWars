{
  "id": "64c231b5edf1bc1ca78281a8",
  "name": "Sorting Madness: part 3",
  "slug": "sorting-madness-part-3",
  "category": "reference",
  "publishedAt": "2023-07-27T09:00:25.451Z",
  "approvedAt": "2023-07-28T17:05:58.683Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/64c231b5edf1bc1ca78281a8",
  "rank": {
    "id": -6,
    "name": "6 kyu",
    "color": "yellow"
  },
  "createdAt": "2023-07-27T08:58:29.658Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "As a data analyst at an online store, you are analyzing the purchasing behavior of your customers.  Each customer can have multiple transactions, each transaction is either a purchase (represented by `is_return` column value of false) or a return (represented by `is_return` column value of true).\n\nThe transactions are recorded in a table called `orders`. The table structure is as follows:\n\n```\ncustomer_id | is_return\n-----------------------\n1           |   true\n1           |   true\n1           |   false\n1           |   false\n2           |   true\n2           |   true\n2           |   true\n2           |   false\n3           |   false\n```\n\nYour task is to write a PostgreSQL SQL query that orders the data in the following way:\n\n1) First, order by `customer_id.`\n2) Then, within each customer, try to alternate between `is_return` = true (return) and `is_return` = false (purchase) as much as possible (starting with `true`). This means that, ideally, each return transaction should be followed by a purchase transaction, and vice versa. However, please note that it might not always be possible to alternate perfectly if a customer has more returns than purchases, or vice versa.\n\nHere is an example of the desired output from the sample data above:\n\n```\ncustomer_id | is_return\n-----------------------\n1           |   true\n1           |   false\n1           |   true\n1           |   false\n2           |   true\n2           |   false\n2           |   true\n2           |   true\n3           |   false\n```\n\nIn this output, within each customer group, the is_return values alternate as much as possible. For instance, for customer 1, the sequence is `true, false, true, false`. For customer 2, the sequence is `true, false, true, true`. The perfect alternation is not possible for 2 as there are more returns than purchases. Lastly, for customer 3, there is only a purchase, so no alternation is possible.",
  "totalAttempts": 332,
  "totalCompleted": 96,
  "totalStars": 8,
  "voteScore": 41,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}