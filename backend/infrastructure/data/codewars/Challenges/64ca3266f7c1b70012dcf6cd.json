{
  "id": "64ca3266f7c1b70012dcf6cd",
  "name": "Tracking Last Large Transactions",
  "slug": "tracking-last-large-transactions",
  "category": "reference",
  "publishedAt": "2023-08-02T12:23:03.538Z",
  "approvedAt": "2023-08-08T10:26:38.073Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/64ca3266f7c1b70012dcf6cd",
  "rank": {
    "id": -6,
    "name": "6 kyu",
    "color": "yellow"
  },
  "createdAt": "2023-08-02T10:39:34.469Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "Within a growing digital bank, the Risk Management team is constantly on the lookout for account behaviors that may indicate potential risks or anomalies. They are specifically interested in tracking larger transactions over 100 units due to their potential financial impact. In order to enhance their surveillance, they have requested a detailed account transaction history that not only outlines all transactions but also pinpoints the last date of each transaction over 100 units. This data will provide valuable insights to track, analyze, and manage the risk associated with these larger transactions.\n\nYou are given a table named `account_transactions` with multiple dates, account IDs, and amounts. Schema of the table is following:\n\n* `date` (date): The date of the transaction.\n* `account_id` (integer): The ID of the account associated with the transaction.\n* `amount` (integer): The amount of the transaction.\n\nYour task is to write a SQL query that retrieves all columns from the table with an additional `last_over_hundred` column which shows the last date upto and including the current date where the amount is strictly over 100 for that specific `account_id`. If no previous amount is over 100, it should be `NULL`.\n\nThe result should be sorted by `account_id` in descending order and then by `date` in ascending order. It is guaranteed that there is at most 1 transaction per date for each of the accounts.  \n\nThe expected output should look like that:\n```\ndate            account_id       amount          last_over_hundred\n2023-01-01      124              100             NULL\n2023-01-06      124              150             2023-01-06\n2023-02-14      124              58              2023-01-06\n2023-01-01      123              12              NULL\n2023-01-06      123              150             2023-01-06\n2023-02-14      123              11              2023-01-06\n2023-05-06      123              16              2023-01-06\n2023-05-16      123              200             2023-05-16\n2023-06-01      123              18              2023-05-16\n2023-06-15      123              17              2023-05-16\n2023-06-18      123              110             2023-06-18\n2023-06-30      123              23              2023-06-18\n2023-07-01      123              45              2023-06-18\n2023-07-12      123              116             2023-07-12\n2023-07-18      123              60              2023-07-12\n```\n\nGLHF!",
  "totalAttempts": 669,
  "totalCompleted": 112,
  "totalStars": 9,
  "voteScore": 38,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}