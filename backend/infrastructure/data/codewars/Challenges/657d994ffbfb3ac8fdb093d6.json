{
  "id": "657d994ffbfb3ac8fdb093d6",
  "name": "Call Center Traffic: Identifying Peak Hours and User Workload",
  "slug": "call-center-traffic-identifying-peak-hours-and-user-workload",
  "category": "reference",
  "publishedAt": "2023-12-20T10:00:55.445Z",
  "approvedAt": "2023-12-21T07:56:52.493Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/657d994ffbfb3ac8fdb093d6",
  "rank": {
    "id": -4,
    "name": "4 kyu",
    "color": "blue"
  },
  "createdAt": "2023-12-16T12:34:23.342Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "Twilight_Sun",
    "url": "https://www.codewars.com/users/Twilight_Sun"
  },
  "description": "Write an SQL query to analyze call volume data for a customer support center. The analysis should focus on identifying peak, off-peak, and quiet hours on a specific date, as well as determining the maximum number of calls handled by a single user during each hour.\n\nWe have `calls` table:\n\n* `id`: (primary key, integer)\n* `username`: (string), representing the user who handled the call\n* `called_time`: (timestamp), representing when the call was made\n\nRequirements:\n\n1) Date Filter:\n    * Analyze calls only for the date `2023-12-14`.\n2) Time Range:\n    * For this analysis, consider the working hours from 9 AM to just before 7 PM. Specifically, you need to analyze call data for each hour within this range. Each hour in the output should represent the calls that occurred during that hour. The time range for each hour is defined as follows:\n        * The \"9 AM\" column should include all calls that happened from 9:00 AM to 9:59:59 AM.\n        * Similarly, each subsequent hour column (e.g., \"10 AM\", \"11 AM\", etc.) should include calls from the start of the hour (HH:00:00) to the end of that hour (HH:59:59).\n        * The final hour, \"6 PM\", will include calls from 6:00 PM to 6:59:59 PM.\n3) Call Volume Analysis:\n    * Determine the total number of calls for each hour within the specified time range.\n    * Identify the hours as 'Peak Hour', 'Off-Peak Hour', or 'Quiet Hour' based on call volume:\n        * `Peak Hour`: The hour with the highest call volume.\n        * `Off-Peak Hour`: The next three hours with the highest call volume.\n        * `Quiet Hour`: All other hours.\n4) Ranking Mechanism:\n    * Rank the hours based on the volume of calls. In case of a tie, give a higher rank to the earlier hour.\n5) Maximum Calls by Single User:\n    * For each hour, determine the maximum number of calls handled by any single user.\n6) Output Format:\n    * Display the hour in a user-friendly format (e.g., '9 AM', '10 AM', ...).\n    * Include columns for the hour, total call count, maximum calls by a single user, and call volume category.\n    * Order the results based on the rank.\n\nExpected Output Columns:\n\n1) `hour`: Formatted hour (e.g., '9 AM', '10 AM', ...).\n2) `call_count`: Total number of calls in the hour.\n3) `max_calls_by_single_user`: Maximum number of calls handled by a single user in the hour.\n4) `call_volume_category`: Categorization of the hour as 'Peak Hour', 'Off-Peak Hour', or 'Quiet Hour'.\n\nAdditional Notes:\n\n* Ensure that all hours within the specified range (9 AM to 6 PM) are represented in the output, even if they have zero calls.\n\n### Desired Output\n\nThe desired output should look like this:\n\n<table><!----><tr><th>hour</th><th>call_count</th><th>max_calls_by_single_user</th><th>call_volume_category</th></tr><tr><td>2 PM</td><td>7</td><td>2</td><td>Peak Hour</td></tr><tr><td>3 PM</td><td>7</td><td>4</td><td>Off-Peak Hour</td></tr><tr><td>10 AM</td><td>5</td><td>2</td><td>Off-Peak Hour</td></tr><tr><td>12 PM</td><td>5</td><td>1</td><td>Off-Peak Hour</td></tr><tr><td>1 PM</td><td>5</td><td>2</td><td>Quiet Hour</td></tr><tr><td>9 AM</td><td>4</td><td>1</td><td>Quiet Hour</td></tr><tr><td>5 PM</td><td>3</td><td>1</td><td>Quiet Hour</td></tr><tr><td>4 PM</td><td>2</td><td>1</td><td>Quiet Hour</td></tr><tr><td>6 PM</td><td>2</td><td>1</td><td>Quiet Hour</td></tr><tr><td>11 AM</td><td>0</td><td>0</td><td>Quiet Hour</td></tr></table>\n\n\nGLHF!\n",
  "totalAttempts": 1743,
  "totalCompleted": 139,
  "totalStars": 17,
  "voteScore": 39,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}