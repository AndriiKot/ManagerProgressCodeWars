{
  "id": "64f07cc12b610b976e067623",
  "name": "Conditional Grouping of User Activities",
  "slug": "conditional-grouping-of-user-activities",
  "category": "reference",
  "publishedAt": "2023-08-31T11:43:19.465Z",
  "approvedAt": "2023-09-13T20:28:56.786Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/64f07cc12b610b976e067623",
  "rank": {
    "id": -6,
    "name": "6 kyu",
    "color": "yellow"
  },
  "createdAt": "2023-08-31T11:42:57.583Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "You work at the platform with registered users and unregistered/deleted users whose usernames in DB have a pattern of \"User\" followed by digits. Your task is to aggregate users' activity data, grouping unregistered/deleted users under the label `GROUP_OTHERS`.\n\n`user_activity`\n\n* `id` (integer) - Unique identifier for each record.\n* `username` (varchar) - Username associated with the activity. May not be unique as multiple records for the same username are possible.\n* `activity_count` (integer) - The count of activities performed by the user.\n\nWrite a SQL query that achieves the following:\n\n1) Groups records based on `username`.\n2) For usernames that start with \"User\" and are followed `only `by digits (i.e. 'User6314923423'), groups them under the label `GROUP_OTHERS`.\n3) Filters out records from the table where `activity_count` is not between 1 and 2000 inclusive, then calculates the total amount of activities for each user.\n4) Sorts the results such that `GROUP_OTHERS` appears first, followed by the rest in alphabetical order.\n\nExpected Output Columns:\n\n* `user` (varchar) - The name of the user. Unregistered users are labeled as `GROUP_OTHERS`.\n* `total_activity` (integer) - The total count of activities performed by each user group.\n\nGLHF!\n\n### Desired Output\n\nThe desired output should look like this:\n\n<table><!----><tr><th>username</th><th>total_activity</th></tr><tr><td>GROUP_OTHERS</td><td>20</td></tr><tr><td>bornForThis</td><td>226</td></tr><tr><td>dfhwze</td><td>248</td></tr><tr><td>matt c</td><td>93</td></tr></table>\n",
  "totalAttempts": 1204,
  "totalCompleted": 111,
  "totalStars": 5,
  "voteScore": 43,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 1
  }
}