{
  "id": "642ff90503d3e2c9426fd500",
  "name": "Exclude 'Adults only' films watchers",
  "slug": "exclude-adults-only-films-watchers",
  "category": "reference",
  "publishedAt": "2023-04-07T11:08:43.993Z",
  "approvedAt": "2023-05-04T17:43:05.096Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/642ff90503d3e2c9426fd500",
  "rank": {
    "id": -6,
    "name": "6 kyu",
    "color": "yellow"
  },
  "createdAt": "2023-04-07T11:05:41.915Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "Write an SQL query to retrieve the top 5 customers who have rented the most movies, excluding customers who have rented at least one movie with an 'NC-17' rating. Subqueries are forbidden to make the task a bit curiouser - you can use `select` only once\n\n##### Notes:\n\n* If two or more customers have the same amount of rentals then sort by last name alphabetically.\n\n### Schema\n\n#### `customer` table:\n```\nColumn       | Type     | Modifiers\n------------ +----------+----------\ncustomer_id  | integer  | not null\nfirst_name   | varchar  | not null\nlast_name    | varchar  | not null\nemail        | varchar  | not null\n```\n\n#### `inventory` table:\n```\nColumn       | Type      | Modifiers\n------------ +-----------+----------\ninventory_id | integer   | not null\nfilm_id      | smallint  | not null\nstore_id     | smallint  | not null\n```\n\n#### `film` table:\n```\nColumn           | Type     | Modifiers\n-----------------+----------+----------\nfilm_id          | integer  | not null\ntitle            | varchar  | not null\ndescription      | text     | not null\nrating           | varchar  | not null\n\n```\n#### `rental` table:\n```\nColumn       | Type      | Modifiers\n-------------+-----------+----------\nrental_id    | integer   | not null\ncustomer_id  | integer   | not null\ninventory_id | integer   | not null\nrental_date  | timestamp | not null\nreturn_date  | timestamp | \n```\n### Desired Output\n\nThe desired output should look like this:\n\n```\ncustomer_id  | full_name     | total_rentals |\n-------------+---------------+---------------+\n   32        | Jami Hayes    | 22            |\n   14        | Hosea Jacobi  | 19            |\n...\n```",
  "totalAttempts": 2339,
  "totalCompleted": 375,
  "totalStars": 16,
  "voteScore": 64,
  "tags": [
    "Databases",
    "SQL",
    "Fundamentals",
    "Restricted"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 1,
    "suggestions": 2
  }
}