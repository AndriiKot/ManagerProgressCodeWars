{
  "id": "64b3aad51cefd8003c1a35f6",
  "name": "Hourly Analysis of Fleet Distances",
  "slug": "hourly-analysis-of-fleet-distances",
  "category": "reference",
  "publishedAt": "2023-07-16T08:32:06.200Z",
  "approvedAt": "2023-08-14T14:49:06.233Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/64b3aad51cefd8003c1a35f6",
  "rank": {
    "id": -6,
    "name": "6 kyu",
    "color": "yellow"
  },
  "createdAt": "2023-07-16T08:31:17.640Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "You are working with a database for a car rental service. One of the tables in this database is named cars. Each row in the cars table represents a single journey made by a vehicle in the fleet.\n\nYour task is to write a SQL query that retrieves data from a specific 10 hour period on July 16, 2023 (from 8:00 to 18:00). The query should provide an hourly breakdown of the total distance travelled by all cars in the fleet during this period. It should also include a formatted running total of the distance travelled, presented as a string in the format: \"Total of N hour(s): {{running total}}\".\n\nSchema of `cars` table:\n\n* `id` (integer): An identifier for each journey, unique across all records in the table.\n* `time` (timestamp): The date and time when the journey took place.\n* `km` (numeric):  The total kilometers travelled during the hour, rounded to one decimal place.\n* `car_id` (integer): A foreign key referencing the `car_info` table, indicating which car made the journey.\n\nThe query should return a table with the following columns:\n\n* `time_from` (text): The start of the hour for which the data is grouped, represented as a string in ISO 8601 format (e.g., '2023-07-16 08:00:00').\n* `time_to` (text): The end of the hour for which the data is grouped, represented as a string in ISO 8601 format (e.g., '2023-07-16 09:00:00').\n* `km` (numeric): The total kilometers travelled during the hour, rounded to one decimal place. Transactions happening exactly at an hour boundary like 17:00 are needed to be included in the group for the upcoming hour (17:00 to 18:00), not the previous hour (16:00 to 17:00).\n* `total_km` (string): A string that contains the running total of kilometers travelled up to and including the current hour, in the format: \"Total of N hour(s): {{running total}}\". N is the hour count, starting from the first hour in the dataset. Running total is rounded to one decimal place.\n\nThe results should be ordered in ascending order by `time_from`. \n\nTips:\n\n* In PostgreSQL, you can cast a timestamp directly to text to get a string in ISO 8601 format. This can simplify your code and make it easier to read\n\nGLHF!\n\n### Desired Output\n\nThe desired output should look like this:\n\n<table><!----><tr><th>time_from</th><th>time_to</th><th>km</th><th>total_km</th></tr><tr><td>2023-07-16 08:00:00</td><td>2023-07-16 09:00:00</td><td>0.593e2</td><td>Total of 1 hour(s): 59.3</td></tr><tr><td>2023-07-16 09:00:00</td><td>2023-07-16 10:00:00</td><td>0.703e2</td><td>Total of 2 hour(s): 129.6</td></tr><tr><td>2023-07-16 10:00:00</td><td>2023-07-16 11:00:00</td><td>0.804e2</td><td>Total of 3 hour(s): 210.0</td></tr></table>\n...\n\n\n\n\n\n\n\n\n",
  "totalAttempts": 899,
  "totalCompleted": 88,
  "totalStars": 9,
  "voteScore": 36,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}