{
  "id": "65705f19f926c71f4c19fcaa",
  "name": "Hotel Guest Transaction Analysis: Booking and Service Payments",
  "slug": "hotel-guest-transaction-analysis-booking-and-service-payments",
  "category": "reference",
  "publishedAt": "2023-12-06T11:47:05.001Z",
  "approvedAt": "2023-12-11T20:59:18.860Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/65705f19f926c71f4c19fcaa",
  "rank": {
    "id": -6,
    "name": "6 kyu",
    "color": "yellow"
  },
  "createdAt": "2023-12-06T11:46:33.822Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "In a hotel booking system, a customer might make an initial payment to book a room ( `initial_booking`) and then make another payment for additional services or amenities during their stay (`additional_services`). In some cases, there might not be a second payment if the customer does not use additional chargeable services. For certain there are no payments other than these two for each `transaction`. \n\nThe data is stored in a table named `hotel_transactions`, structured as follows:\n\n* `id`: (int) - primary key\n* `transaction` (int) - An identifier for the booking. Note that this ID is the same for both the initial booking and any additional service charge made by the same guest.\n* `name`: (string) - the name of the customer. It remains consistent for all transactions within the same transaction group.\n* `receipt`: (string) - the receipt identifier.\n* `datetime`: (datetime) - the date and time of the transaction.\n\nCreate an SQL query that groups the transactions by each guest's booking. For each guest, you should display:\n\n1) `transaction` - The transaction identifier.\n2) `name` - The name of the guest.\n3) `initial_booking` - The first receipt and its corresponding datetime (as text datatype) in parentheses in one column.\n4) `additional_services` - The second receipt and its corresponding datetime in parentheses, if it exists. If there's only one transaction, this column should display NULL.\n\nResult needs to be ordered by `transaction` in descending order. It can be guaranteed that the second receipt's datetime will always be later than the first receipt's datetime for each transaction.\n\nImportant Consideration: Be mindful of scenarios where receipt identifiers may not be in chronological order. The query must ensure chronological accuracy based on the datetime column, not the alphabetical order of the receipt identifiers. For example, a receipt labeled 'R100' might be issued after 'R101' chronologically, and the query should handle such cases correctly.\n\nGLHF!\n\n",
  "totalAttempts": 596,
  "totalCompleted": 118,
  "totalStars": 4,
  "voteScore": 39,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}