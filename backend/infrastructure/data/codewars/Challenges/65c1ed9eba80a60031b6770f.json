{
  "id": "65c1ed9eba80a60031b6770f",
  "name": "Weekly Ticket Status Analysis: Tracking Open, Closed, and Active Tickets",
  "slug": "weekly-ticket-status-analysis-tracking-open-closed-and-active-tickets",
  "category": "reference",
  "publishedAt": "2024-02-06T10:45:42.778Z",
  "approvedAt": "2024-02-10T12:26:01.455Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/65c1ed9eba80a60031b6770f",
  "rank": {
    "id": -5,
    "name": "5 kyu",
    "color": "yellow"
  },
  "createdAt": "2024-02-06T08:28:14.351Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "In many businesses, particularly in IT and customer support, tracking the status of tickets (requests, tasks, issues, etc.) is crucial for efficient operations and customer satisfaction. Understanding how many tickets are opened, closed, and actively being worked on in a given time frame can help in resource planning, identifying bottlenecks, and improving overall service quality. This task focuses on analyzing ticket status on a weekly basis over the course of a year.\n\nImagine a company that uses a ticketing system to handle customer service requests. Each ticket has an opening date and, once resolved, a closing date. The company wants to analyze these tickets on a weekly basis to understand the volume of work and ensure adequate staffing and resources.\n\nYou are given a PostgreSQL database containing a table named `ticket_status` with the following structure:\n\n* `ticket_id` (int, primary key): An integer representing the unique ID of the ticket.\n* `start_date` (date): The date when the ticket was opened (created).\n* `finish_date` (date, nullable): The date when the ticket was closed. If the ticket is still open, this field is NULL.\n\nThe goal is to write an SQL query that provides a weekly report for the year 2024. This report should include the following columns:\n\n1) `week`: The week number of the year, including the start and end dates of that week in the format \"Week X (YYYY-MM-DD - YYYY-MM-DD)\".\n2) `opened`: The number of tickets that were opened during that week.\n3) `closed`: The number of tickets that were closed during that week.\n4) `active`: The number of tickets that were opened at any time before or during that week and have not been closed by the end of that week.\n\nRequirements:\n\n1) Weekly Segmentation: The analysis should cover the entire calendar year, divided into ISO weeks. Each week is defined as a period from Monday to Sunday, so thus partial weeks of the next year should be excluded.\n2) Date Range in Week Column: Each week should be labeled with its corresponding start and end dates.\n3) Active Ticket Calculation: A ticket is active in a week if it was opened before the end of that week and either still open or closed after the start of that week.\n4) Handling NULL `finish_date`: If `finish_date` is NULL, the ticket should be considered as still open (or active).\n\nOrder the results by week, starting from the first week of 2024.\n\nLet's take this sample data:\n\n* Ticket 101: Opened on 2024-01-01 and closed on 2024-01-15.\n* Ticket 102: Opened on 2024-01-03 and closed on 2024-01-18.\n* Ticket 103: Opened on 2024-01-05 and still open (finish_date is NULL).\n* Ticket 104: Opened on 2024-01-08 and closed on 2024-01-22.\n* Ticket 105: Opened on 2024-01-12 and closed on 2024-02-05\n* Ticket 106: Opened on 2024-01-15 and still open (finish_date is NULL).\n* Ticket 107: Opened on 2024-01-20 and closed on 2024-02-10.\n\nThe desired output should look like this:\n\n<table><!----><tr><th>week</th><th>opened</th><th>closed</th><th>active</th></tr><tr><td>Week 1 (2024-01-01 - 2024-01-07)</td><td>3</td><td>0</td><td>3</td></tr><tr><td>Week 2 (2024-01-08 - 2024-01-14)</td><td>2</td><td>0</td><td>5</td></tr><tr><td>Week 3 (2024-01-15 - 2024-01-21)</td><td>2</td><td>2</td><td>5</td></tr><tr><td>Week 4 (2024-01-22 - 2024-01-28)</td><td>0</td><td>1</td><td>4</td></tr><tr><td>Week 5 (2024-01-29 - 2024-02-04)</td><td>0</td><td>0</td><td>4</td></tr><tr><td>Week 6 (2024-02-05 - 2024-02-11)</td><td>0</td><td>2</td><td>2</td></tr><tr><td>Week 7 (2024-02-12 - 2024-02-18)</td><td>0</td><td>0</td><td>2</td></tr></table>\n...\n\n\nGLHF!\n\n\n\n\n",
  "totalAttempts": 658,
  "totalCompleted": 83,
  "totalStars": 8,
  "voteScore": 27,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}