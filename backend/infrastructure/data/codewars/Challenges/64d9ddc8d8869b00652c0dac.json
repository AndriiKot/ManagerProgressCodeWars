{
  "id": "64d9ddc8d8869b00652c0dac",
  "name": "Grouping and Numbering Shipments Based on Status Codes",
  "slug": "grouping-and-numbering-shipments-based-on-status-codes",
  "category": "reference",
  "publishedAt": "2023-08-14T07:54:50.793Z",
  "approvedAt": "2023-08-16T18:59:57.877Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/64d9ddc8d8869b00652c0dac",
  "rank": {
    "id": -6,
    "name": "6 kyu",
    "color": "yellow"
  },
  "createdAt": "2023-08-14T07:54:48.117Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "You are working with an e-commerce company that wants to track the status of their product orders. You have been tasked with writing a SQL query that groups orders into shipping batches. Every time an order has a status code of 4 (shipped), the shipment batch number needs to restart at 1.\n\nTable Schema (`order_status`):\n\n* `order_id` (integer) - primary key.\n* `product_name` (varchar) - Name of the product associated with the order.\n* `status_code` (integer) - Code representing the status of the order (e.g., 0 for received, 4 for shipped).\n\nSample Data:\n\n```\n| order_id  | product_name  | status_code  |\n+-----------+---------------+--------------+\n| 1         | Laptop        | 0            |\n| 2         | Smartphone    | 1            |\n| 3         | Tablet        | 1            |\n| 4         | Monitor       | 2            |\n| 5         | Headphones    | 3            |\n| 6         | Keyboard      | 4            |\n| 7         | Mouse         | 5            |\n| 8         | Printer       | 5            |\n| 9         | Webcam        | 6            |\n| 10        | Laptop        | 4            |\n| 11        | Smartphone    | 5            |\n| 12        | Tablet        | 6            |\n```\nWrite a SQL query that adds a new column named `shipment_batch_number`. This column should represent the shipment batch number and restart at 1 every time the status code is 4. When first`status_code`=4 is still not reached, it should be 0.\n\nExpected Output:\n\n```\n| order_id  | product_name  | status_code  | shipment_batch_number |\n+-----------+---------------+--------------+-----------------------+\n| 1         | Laptop        | 0            | 0                     |\n| 2         | Smartphone    | 1            | 0                     |\n| 3         | Tablet        | 1            | 0                     |\n| 4         | Monitor       | 2            | 0                     |\n| 5         | Headphones    | 3            | 0                     |\n| 6         | Keyboard      | 4            | 1                     |\n| 7         | Mouse         | 5            | 2                     |\n| 8         | Printer       | 5            | 3                     |\n| 9         | Webcam        | 6            | 4                     |\n| 10        | Laptop        | 4            | 1                     |\n| 11        | Smartphone    | 5            | 2                     |\n| 12        | Tablet        | 6            | 3                     |\n```\n\nThe result should be ordered by `order_id` ascending order.\n\nGLHF!\n\n\n\n\n",
  "totalAttempts": 303,
  "totalCompleted": 80,
  "totalStars": 8,
  "voteScore": 35,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}