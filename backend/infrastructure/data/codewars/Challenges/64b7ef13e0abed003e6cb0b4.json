{
  "id": "64b7ef13e0abed003e6cb0b4",
  "name": " Days to Reach a Cumulative Transaction Threshold",
  "slug": "days-to-reach-a-cumulative-transaction-threshold",
  "category": "reference",
  "publishedAt": "2023-07-19T15:05:40.609Z",
  "approvedAt": "2023-08-08T10:26:49.846Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/64b7ef13e0abed003e6cb0b4",
  "rank": {
    "id": -6,
    "name": "6 kyu",
    "color": "yellow"
  },
  "createdAt": "2023-07-19T14:11:31.064Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "You are a data analyst for a streaming service provider that operates on a tiered subscription model. Understanding user behavior to optimize this model is crucial. One specific area of interest is to monitor the spending pattern of users from the time they join the platform. This will help identify how long it typically takes for users to reach certain spending thresholds, and in turn, informs strategies for tier adjustments.\n\nWe have `transactions` table that contains the following columns: `id` (integer), `date` (date in 'YYYY-MM-DD' format), `amount` (integer).\n\nYour task is to write a SQL query that retrieves a sequence of transaction entries, sorted by `id` in ascending order (oldest first), where the total amount from the first transaction to the current row (when arranged by date in chronological order) reaches or exceeds a limit of 15. The result should also include a new column named `days_to_reach_threshold` that shows the number of days from the first transaction to the transaction where the cumulative amount reaches or exceeds the threshold. This value should be present only in the last row of the result set.\n\nSuppose the transactions table has the following data:\n\n```\nid  |    date   | amount \n----+-----------+--------\n1   | 2023-01-01|   3 \n2   | 2023-02-01|   5 \n3   | 2023-03-01|   4\n4   | 2023-04-01|   2 \n5   | 2023-05-01|   7 \n6   | 2023-06-01|   4\n```\nFor the specified threshold of 15, your query should return the following result:\n\n```\nid |    date    | amount | days_to_reach_threshold\n---+------------+--------+-----------------------\n1  | 2023-01-01 |   3    |  <null>\n2  | 2023-02-01 |   5    |  <null>\n3  | 2023-03-01 |   4    |  <null>\n4  | 2023-04-01 |   2    |  <null>\n5  | 2023-05-01 |   7    |  120\n```\n\nGLHF!",
  "totalAttempts": 399,
  "totalCompleted": 92,
  "totalStars": 5,
  "voteScore": 35,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}