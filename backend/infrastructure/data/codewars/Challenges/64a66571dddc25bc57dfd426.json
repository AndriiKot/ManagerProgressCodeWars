{
  "id": "64a66571dddc25bc57dfd426",
  "name": "Pairing States by Streaming Volume",
  "slug": "pairing-states-by-streaming-volume",
  "category": "reference",
  "publishedAt": "2023-07-06T06:58:22.799Z",
  "approvedAt": "2023-07-11T03:49:57.216Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/64a66571dddc25bc57dfd426",
  "rank": {
    "id": -7,
    "name": "7 kyu",
    "color": "white"
  },
  "createdAt": "2023-07-06T06:55:45.927Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "You have the `state_streams` table, where each raw contains the abbreviation of the state and the total hours of streaming from the video hosting:\n\n<table><thead><tr><th>state (String)</th><th>total_streams (Integer)</th></tr></thead><tbody><tr><td>NC</td><td>34569</td></tr><tr><td>SC</td><td>33999</td></tr><tr><td>CA</td><td>98324</td></tr><tr><td>MA</td><td>19345</td></tr><tr><td>..</td><td>..</td></tr></tbody></table>\n\nWrite an SQL query that selects pairs of states from the `state_streams` table where the total number of streams is less than a thousand of each other.\n\n* Your query should return a result set with three columns: `state_a`, `state_b` and `difference`.\n* Each row in the result set should represent a pair of states whose total_streams difference is less than 1000 along with displaying this difference.\n* The same pair of states should not appear more than once in the result set. For example, if you have a pair (NC, SC), you should not have another pair (SC, NC) in the results.\n* The states in both columns of your result set should be ordered in ascending alphabetical order. First by `state_a` and afterwards by `state_b`\n* `state` column is unique - there are no duplicate states.\n\n### Desired Output\n\nFor the example above, the desired output should look like this:\n\n<table><!----><tr><th>state_a</th><th>state_b</th><th>difference</th></tr><tr><td>NC</td><td>SC</td><td>570</td></tr></table>\n\n\n\n\n\n",
  "totalAttempts": 1511,
  "totalCompleted": 206,
  "totalStars": 7,
  "voteScore": 46,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 1,
    "suggestions": 0
  }
}