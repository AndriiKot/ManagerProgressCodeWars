{
  "id": "67794624346643af4622a25d",
  "name": "Building a User Leaderboard with Engagement Metrics",
  "slug": "building-a-user-leaderboard-with-engagement-metrics",
  "category": "reference",
  "publishedAt": "2025-01-04T14:31:47.269Z",
  "approvedAt": "2025-01-04T23:21:09.549Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/67794624346643af4622a25d",
  "rank": {
    "id": -6,
    "name": "6 kyu",
    "color": "yellow"
  },
  "createdAt": "2025-01-04T14:31:00.510Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "You are working with a database that tracks user engagement in an online platform. Users can link their profiles to GitHub accounts to showcase their coding portfolios.\n\nWe have `users` table:\n\n* `id` (int, primary key): Unique identifier for the user.\n* `username` (varchar):\tThe user's username.\n* `likes_count` (int):\tTotal number of likes received by the user.\n* `comments_count` (int):\tTotal number of comments received by the user.\n* `shares_count` (int):\tTotal number of shares received by the user.\n* `date_joined` (date):\tThe date the user joined the platform.\n\nand `github_accounts` table:\n\n* `id` (int, primary key):\tUnique identifier for the GitHub account.\n* `user_id` (int, foreign key on `users` table):\tThe user ID this GitHub account is linked to.\n* `github_handle` (varchar): the GitHub handle or username.\n\nWrite a query to generate the top 10 most engaged users. Calculate their engagement points using this formula:\n\n`engagement_points = likes_count * 1  + comments_count * 2 + shares_count * 3`\n\nIf a user has a linked GitHub account, they receive a bonus of 50 points to their engagement score. Include this bonus when calculating engagement points. \n\nRanking Logic:\n\n1) Users are ranked by their engagement points in descending order.\n2) If two users have the same engagement points, the one who joined earlier ranks higher.\n3) If both engagement points and join dates are the same, the user whose username comes first alphabetically ranks higher.\n\nYour query should include the following columns:\n\n1) `rank` (int)\n2) `username` (varchar).\n4) `engagement_points` (int): including the GitHub bonus, if applicable\n5) `date_joined` (date).\n6) `github_handle` (varchar, nullable).\n\n\nFor this sample data: \n\n```\nusers: \n\n| id | username | likes_count | comments_count | shares_count | date_joined|\n+----+----------+-------------+----------------+-------------+------------+\n| 1  | Alice    | 10          | 5              | 2           | 2023-01-01 |\n| 2  | Bob      | 8           | 10             | 5           | 2023-02-01 |\n| 3  | Charlie  | 15          | 3              | 8           | 2023-03-01 |\n| 4  | Diana    | 5           | 2              | 1           | 2023-04-01 |\n| 5  | Eve      | 20          | 7              | 3           | 2023-05-01 |\n| 6  | Frank    | 12          | 8              | 4           | 2023-06-01 |\n| 7  | Grace    | 7           | 3              | 6           | 2023-07-01 |\n| 8  | Heidi    | 9           | 4              | 2           | 2023-08-01 |\n| 9  | Ivan     | 6           | 3              | 1           | 2023-09-01 |\n| 10 | Judy     | 25          | 10             | 12          | 2023-10-01 |\n```\n\n```\ngithub_accounts:\n\n| id | user_id | github_handle    |\n+----+---------+------------------+\n| 1  | 1       | alice_dev        |\n| 2  | 3       | charlie_coder    |\n| 3  | 5       | eve_tech         |\n| 4  | 7       | grace_code       |\n| 5  | 10      | judy_programmer  |\n```\n\nthe desired output is the following:\n \n ```\n| rank | username | engagement_points  | date_joined  | github_handle    |\n+------+----------+--------------------+-------------+-------------------+\n| 1    | Judy     | 131                | 2023-10-01  | judy_programmer   |\n| 2    | Charlie  | 95                 | 2023-03-01  | charlie_coder     |\n| 3    | Eve      | 93                 | 2023-05-01  | eve_tech          |\n| 4    | Grace    | 81                 | 2023-07-01  | grace_code        |\n| 5    | Alice    | 76                 | 2023-01-01  | alice_dev         |\n| 6    | Bob      | 43                 | 2023-02-01  | NULL              |\n| 7    | Frank    | 40                 | 2023-06-01  | NULL              |\n| 8    | Heidi    | 23                 | 2023-08-01  | NULL              |\n| 9    | Ivan     | 15                 | 2023-09-01  | NULL              |\n| 10   | Diana    | 12                 | 2023-04-01  | NULL              |\n```\n\nGLHF!\n\n\n\n\n",
  "totalAttempts": 547,
  "totalCompleted": 147,
  "totalStars": 4,
  "voteScore": 47,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}