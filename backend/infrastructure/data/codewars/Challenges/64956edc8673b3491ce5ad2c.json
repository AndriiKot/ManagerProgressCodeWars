{
  "id": "64956edc8673b3491ce5ad2c",
  "name": "Students to expel",
  "slug": "students-to-expel",
  "category": "reference",
  "publishedAt": "2023-06-23T12:57:24.237Z",
  "approvedAt": "2023-06-28T09:26:38.560Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/64956edc8673b3491ce5ad2c",
  "rank": {
    "id": -5,
    "name": "5 kyu",
    "color": "yellow"
  },
  "createdAt": "2023-06-23T10:07:24.605Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "Let's consider a case where we have a `students` table and a `courses` table. The tables have the following structure:\n\n`students`: \n```\n| id  | name     | email               |\n|-----|----------|---------------------|\n| 1   | John     | john@example.com    |\n| 2   | Sarah    | sarah@example.com   |\n| 3   | Robert   | robert@example.com  |\n...\n```\n`courses`: \n```\n| id  | student_id | course_name | score |\n|-----|------------|-------------|-------|\n| 1   | 1          | Math        | 90    |\n| 2   | 1          | Science     | 85    |\n| 3   | 1          | Physics     | 92    |\n| 4   | 1          | Literature  | 80    |\n...\n```\n\nThe university is considering expelling students who either quit their studies or are consistently performing poorly in their courses. A student who quits is defined as a student with no records in the courses table. A student who is performing poorly is defined as a student with 3 or more courses with a grade less than 60.\n\nWrite a SQL query that retrieves a list of students who qualify for expulsion based on the criteria described above.\n\nThe query should return the following columns:\n\n* `student_id`: The ID of the student\n* `name`: The name of the student\n* `reason`: The reason for expelling the student. It should say either \"quit studying\" if the student has no records in the courses table, or \"failed in [List of Courses]\" where [List of Courses] is a comma-separated list of the courses that the student has failed. Each course in the list should be followed by the grade in parentheses. Failed courses should be sorted in ascending alphabetical order.\n\nThe result should be ordered by the student ID in ascending order.\n\nGood Luck!\n\n### Desired Output\n\nThe desired output should look like this:\n\n<table><!----><tr><th>student_id</th><th>name</th><th>reason</th></tr><tr><td>10</td><td>James</td><td>failed in Math(59), Physics(57), Science(58)</td></tr><tr><td>11</td><td>David</td><td>failed in Literature(58), Math(55), Physics(57), Science(56)</td></tr><tr><td>12</td><td>Lucy</td><td>quit studying</td></tr><tr><td>13</td><td>Daniel</td><td>quit studying</td></tr><tr><td>14</td><td>Grace</td><td>quit studying</td></tr></table>\n\n",
  "totalAttempts": 2576,
  "totalCompleted": 330,
  "totalStars": 17,
  "voteScore": 55,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}