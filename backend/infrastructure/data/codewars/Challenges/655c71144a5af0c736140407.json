{
  "id": "655c71144a5af0c736140407",
  "name": "Customer Support System:  Users with Multiple Distinct Usernames",
  "slug": "customer-support-system-users-with-multiple-distinct-usernames",
  "category": "reference",
  "publishedAt": "2023-11-27T10:41:46.624Z",
  "approvedAt": "2023-12-06T17:08:02.279Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/655c71144a5af0c736140407",
  "rank": {
    "id": -6,
    "name": "6 kyu",
    "color": "yellow"
  },
  "createdAt": "2023-11-21T08:57:56.899Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "Let's consider a scenario of a customer support system where users can create multiple support tickets. In this system, each user has a unique user ID (`user_id`), but they can enter their name (`user_name`) freely for each ticket they create. Over time, a single user might use different names (intentionally or by mistake) while creating multiple tickets.\n\nWe have two tables: `users` and `tickets`. The `users` table stores user information, and the `tickets` table stores support tickets, each associated with a user by `user_id`. We want to find cases where the same user has used different names in different tickets.\n\n`tickets`:\n\n* `id` (integer): primary key\n* `user_id` (integer): foreign key reference to the users table.\n* `user_name`: (string): the username associated with the ticket.\n\n`users`:\n\n* `id` (integer): primary key\n* `email` (string): email of the user\n\n\nThe query should identify user_ids that have been associated with more than one distinct `user_name`. The distinctness of usernames should be considered in a case-insensitive manner (e.g., 'Alice', 'ALICE', and 'alice' should be treated as the same name).\n\nThe results should be ordered first by `user_id` in ascending order. Within each `user_id`, usernames should be sorted alphabetically in ascending order in a case-insensitive manner.\nIf the same username (in different cases) is found, the query should select the one associated with the latest ticket based on the ticket's ID.\n\nThe query should output two columns: `user_id` and `user_name` where each row should represent a distinct username for a given `user_id`.\n\nExample Scenario:\n\nIf `user_id`=4 has tickets with usernames 'Twilight_Sun', 'Dawn_Sun', and 'twilight_Sun', the query should list 'Dawn_Sun' and either 'Twilight_Sun' or 'twilight_Sun' based on which was entered last in the system.\n\nGLHF!",
  "totalAttempts": 782,
  "totalCompleted": 84,
  "totalStars": 4,
  "voteScore": 36,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}