{
  "id": "6502ca42c1845329cdbff139",
  "name": "Ranking based on  Town and Property Type Combinations ",
  "slug": "ranking-based-on-town-and-property-type-combinations",
  "category": "reference",
  "publishedAt": "2023-09-14T08:55:02.656Z",
  "approvedAt": "2023-09-20T18:31:46.529Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/6502ca42c1845329cdbff139",
  "rank": {
    "id": -6,
    "name": "6 kyu",
    "color": "yellow"
  },
  "createdAt": "2023-09-14T08:54:26.456Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "You work for a real estate company that has multiple property listings across various towns and cities. The company maintains a table called `customer_preferences` where each record signifies a customer's interest in a particular type of property in a specific town or city.\n\nIt's important to note that not all customer preferences end up in actual orders.\n\nThe marketing department has requested a ranking of property types across different towns. They want this ranking to include all combinations of towns and property types indicated in `customer_preferences`, even if no actual order has been placed for a given combination. This will help the marketing team understand market gaps and opportunities.\n\nSchema:\n\n`customer_preferences`: \n\n* `customer_id` (integer) - Unique identifier for each customer\n* `town` (varchar) - Name of the town or city where the customer is interested in finding a property\n* `property_type` (varchar) - The type of property the customer is interested in, e.g., Apartment, TownHouse, Condo, MultiFamily\n\n`order_info`:\n\n* `order_id` (integer) - Unique identifier for each order\n* `customer_id` (integer) - Foreign Key, references the unique identifier in the customer_preferences table\n\n\nWrite an SQL query to:\n\n1) Rank each unique combination of `town` and `property_type` in the customer_preferences table.  The ranking should be ordered first by town in ascending alphabetical order and then by property_type in ascending alphabetical order.\n2) Include this ranking in the output, even if there are no corresponding orders for that combination in the `order_info` table. In such cases, display NULL for the order_id.\n\nExpected Output:\n\n1) `rank_order` (integer) - Rank for each unique combination of `town` and `property_type`\n2) `town` (varchar) - The name of the town or city\n3) `property_type` (varchar) - The type of property\n4) `customer_id` (integer) - The ID of the customer interested in this type of property and town\n5) `order_id` (integer/null) - The order ID related to the customer, or NULL if no order is associated with that combination\n\nSort the output first by `rank_order`, then by `customer_id`, and finally by `order_id` â€” all in ascending order.\n\nGLHF!\n\n### Desired Output\n\nThe desired output should look like this:\n\n<table><!----><tr><th>rank_order</th><th>town</th><th>property_type</th><th>customer_id</th><th>order_id</th></tr><tr><td>1</td><td>Austin</td><td>Condo</td><td>3</td><td></td></tr><tr><td>2</td><td>Dallas</td><td>MultiFamily</td><td>4</td><td>2</td></tr><tr><td>3</td><td>Houston</td><td>Apartment</td><td>1</td><td>1</td></tr><tr><td>3</td><td>Houston</td><td>Apartment</td><td>1</td><td>5</td></tr><tr><td>4</td><td>Houston</td><td>TownHouse</td><td>2</td><td>3</td></tr><tr><td>4</td><td>Houston</td><td>TownHouse</td><td>2</td><td>4</td></tr></table>\n\n",
  "totalAttempts": 368,
  "totalCompleted": 109,
  "totalStars": 5,
  "voteScore": 42,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 1,
    "suggestions": 0
  }
}