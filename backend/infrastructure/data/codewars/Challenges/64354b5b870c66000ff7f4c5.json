{
  "id": "64354b5b870c66000ff7f4c5",
  "name": "Film Category Ratings Breakdown",
  "slug": "film-category-ratings-breakdown",
  "category": "reference",
  "publishedAt": "2023-04-11T12:02:08.902Z",
  "approvedAt": "2023-05-15T03:27:50.527Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/64354b5b870c66000ff7f4c5",
  "rank": {
    "id": -6,
    "name": "6 kyu",
    "color": "yellow"
  },
  "createdAt": "2023-04-11T11:58:19.407Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "ejini战神",
    "url": "https://www.codewars.com/users/ejini%E6%88%98%E7%A5%9E"
  },
  "description": "Write an SQL query to retrieve the percentage of films with each rating for each category in the DVD rental database. The query should display the following columns:\n\n* `category_name`: The name of the category that the films belong to.\n* `film_rating`: The rating of the films in the category.\n* `percentage`: The percentage of films with the given rating in the category. This param should be rounded to 3 decimal places (and exactly 3 decimal places should be displayed).\n\nThe query result should be ordered by category_name in ascending order, and then by percentage in descending orders. If there are tied percentages for a given category, the results should be ordered by film rating in alphabetical order. \n\n##### Notes:\n\n* for the sample tests, static dump of [DVD Rental Sample Database](http://www.postgresqltutorial.com/postgresql-sample-database/) is used, for the final solution - random tests. \n*  The percentage should be calculated by dividing the count of films with the given rating by the total count of films in the category, multiplied by 100\n* please use `numeric` type to display percentage \n\nGood luck!\n\n### Schema\n\n#### `film` table:\n```\nColumn           | Type     | Modifiers\n-----------------+----------+----------\nfilm_id          | integer  | not null\ntitle            | varchar  | not null\ndescription      | text     | not null\nrating           | varchar  | not null\n```\n\n#### `film_category` table:\n```\nColumn      | Type      | Modifiers\n------------+---------- +----------\nfilm_id     | smallint  | not null\ncategory_id | smallint  | not null\n````\n#### `category` table:\n```\nColumn      | Type      | Modifiers\n------------+-----------+----------\ncategory_id | smallint  | not null\nname        | text      | not null\n```\n\n### Desired Output\n\nThe desired output should look like this:\n\n```\n| category_name | film_rating | percentage |\n|---------------|-------------|------------|\n| Action        | NC-17       | 0.325e2    |\n| Action        | R           | 0.2e2      |\n| ...           | ...         | ...        |\n```\n\n\n\n\n\n\n\n\n\n\n",
  "totalAttempts": 2143,
  "totalCompleted": 262,
  "totalStars": 10,
  "voteScore": 52,
  "tags": [
    "SQL",
    "Fundamentals",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}