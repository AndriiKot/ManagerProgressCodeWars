{
  "id": "644258f853c27ca88cfc29b0",
  "name": "Analyzing Customer Rental Trends: Identifying Popular Movie Genres Across Multiple Months",
  "slug": "analyzing-customer-rental-trends-identifying-popular-movie-genres-across-multiple-months",
  "category": "reference",
  "publishedAt": "2023-04-21T09:39:22.566Z",
  "approvedAt": "2023-05-31T07:41:42.641Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/644258f853c27ca88cfc29b0",
  "rank": {
    "id": -6,
    "name": "6 kyu",
    "color": "yellow"
  },
  "createdAt": "2023-04-21T09:35:52.907Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "You work for a DVD rental store that wants to understand which movie genres are the most popular among customers who have rented at least one movie during multiple months. By analyzing rental data over a longer period of time, the store owner hopes to gain insights into most active customer's preferences and identify trends that can inform their business decisions as well as which genres may be experiencing a surge or decline in popularity.\n\nYour task is to write a SQL query to identify the top five most popular movie genres among customers who have rented `at least one movie` during the months of May, June, and July of 2005 (in `each` of these 3 months), regardless of whether they rented movies in other months. \n\n##### Notes:\n\n*  for the sample tests, static dump of [DVD Rental Sample Database](http://www.postgresqltutorial.com/postgresql-sample-database/) is used, for the final solution - random tests.\n* by `popularity` is meant the quantity of rentals by the eligible customers, regardless of the period in which the rental was made\n* by `genre`- `category.name` from `category` table\n* List should be sorted by the quantaty of rentals from higher to lower and if number of rentals is the same - then by title of category alphabetically\n\nGood luck!\n\n### Schema\n\n#### `customer` table:\n```\nColumn       | Type     | Modifiers\n------------ +----------+----------\ncustomer_id  | integer  | not null\nfirst_name   | varchar  | not null\nlast_name    | varchar  | not null\n```\n\n#### `film` table:\n```\nColumn           | Type     | Modifiers\n-----------------+----------+----------\nfilm_id          | integer  | not null\ntitle            | varchar  | not null\ndescription      | text     | not null\nrating           | varchar  | not null\n```\n\n#### `film_category` table:\n```\nColumn      | Type      | Modifiers\n------------+---------- +----------\nfilm_id     | smallint  | not null\ncategory_id | smallint  | not null\n````\n#### `category` table:\n```\nColumn      | Type      | Modifiers\n------------+-----------+----------\ncategory_id | smallint  | not null\nname        | text      | not null\n```\n\n#### `rental` table:\n```\nColumn       | Type      | Modifiers\n-------------+-----------+----------\nrental_id    | integer   | not null\ncustomer_id  | integer   | not null\ninventory_id | integer   | not null\nrental_date  | timestamp | not null\nreturn_date  | timestamp | \n```\n\n#### `inventory` table:\n```\nColumn       | Type      | Modifiers\n------------ +-----------+----------\ninventory_id | integer   | not null\nfilm_id      | smallint  | not null\nstore_id     | smallint  | not null\n```\n\n### Desired Output\n\nThe desired output should look like this:\n```\n  genre   |  total_rentals |\n----------+----------------|\n  Action  |  1035          | \n  Sci-Fi  |  1004          |\n\n",
  "totalAttempts": 1212,
  "totalCompleted": 139,
  "totalStars": 17,
  "voteScore": 37,
  "tags": [
    "Databases",
    "SQL",
    "Fundamentals"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}