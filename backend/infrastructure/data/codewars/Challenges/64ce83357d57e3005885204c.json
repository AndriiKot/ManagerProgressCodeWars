{
  "id": "64ce83357d57e3005885204c",
  "name": "Extracting and Ranking Unique Tags ",
  "slug": "extracting-and-ranking-unique-tags",
  "category": "reference",
  "publishedAt": "2023-08-05T17:15:13.574Z",
  "approvedAt": "2023-08-06T10:24:59.629Z",
  "languages": [
    "sql"
  ],
  "url": "https://www.codewars.com/kata/64ce83357d57e3005885204c",
  "rank": {
    "id": -6,
    "name": "6 kyu",
    "color": "yellow"
  },
  "createdAt": "2023-08-05T17:13:25.333Z",
  "createdBy": {
    "username": "bornForThis",
    "url": "https://www.codewars.com/users/bornForThis"
  },
  "approvedBy": {
    "username": "dfhwze",
    "url": "https://www.codewars.com/users/dfhwze"
  },
  "description": "Given a PostgreSQL table `user_tags` with the following schema:\n\n* `user_id` (integer) - Unique identifier for the user.\n* `tags` (string) - Comma-separated string of tags associated with the user.\n\nYou are tasked to write a PostgreSQL query that selects all unique tags, counts the number of occurrences for each tag (`tag_count`), and assigns a rank to each tag based on the number of occurrences (`tag_rank`). The tags with the highest number of occurrences should have the lowest rank. If two or more tags have the same number of occurrences, they should be ranked in alphabetical order. In other words, among tags that have the same `tag_count` value, the one that comes first in alphabetical order will receive the lower rank (higher position). \n\nFor example, consider the following sample data:\n\n```\nuser_id | tags\n--------+------------\n1       | word1,word2,word3\n2       | word2,word4\n3       | word3,word5,word6,word7\n```\n\nThe desired output for this sample data is:\n\n```\ntag_rank | tag   | tag_count\n---------+-------+---------\n1        | word2 | 2\n2        | word3 | 2\n3        | word1 | 1\n4        | word4 | 1\n5        | word5 | 1\n6        | word6 | 1\n7        | word7 | 1\n```\n\nGLHF!",
  "totalAttempts": 479,
  "totalCompleted": 150,
  "totalStars": 4,
  "voteScore": 46,
  "tags": [
    "SQL",
    "Databases"
  ],
  "contributorsWanted": true,
  "unresolved": {
    "issues": 0,
    "suggestions": 0
  }
}